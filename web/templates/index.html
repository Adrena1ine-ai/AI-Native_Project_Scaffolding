{% extends "base.html" %}

{% block title %}AI Toolkit ‚Äî –ì–ª–∞–≤–Ω–∞—è{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="page-header" style="margin-bottom: 4rem; padding: 3rem 0;">
    <span class="page-title-icon">üöÄ</span>
    <h1 class="page-title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ AI Toolkit!</h1>
    <p class="page-subtitle">
        –°–æ–∑–¥–∞–≤–∞–π –ø—Ä–æ–µ–∫—Ç—ã, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞–º–∏.
        –í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å.
    </p>
</div>

<!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
<div class="card-grid">
    <!-- –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç -->
    <a href="/create" class="card" style="text-decoration: none;">
        <div class="card-icon">üÜï</div>
        <h2 class="card-title">–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</h2>
        <p class="card-description">
            –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, –∑–∞—â–∏—Ç–æ–π –æ—Ç venv –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è —Ç–≤–æ–µ–π IDE.
        </p>
        <div style="margin-top: 1rem;">
            <span class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å ‚Üí</span>
        </div>
    </a>
    
    <!-- –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç -->
    <a href="/cleanup" class="card" style="text-decoration: none;">
        <div class="card-icon">üßπ</div>
        <h2 class="card-title">–û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç</h2>
        <p class="card-description">
            –ù–∞–π–¥–∏ –∏ –∏—Å–ø—Ä–∞–≤—å –ø—Ä–æ–±–ª–µ–º—ã –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –ø—Ä–æ–µ–∫—Ç–µ: venv –≤–Ω—É—Ç—Ä–∏, –±–æ–ª—å—à–∏–µ –ª–æ–≥–∏, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥–∏.
        </p>
        <div style="margin-top: 1rem;">
            <span class="btn btn-warning">–û—á–∏—Å—Ç–∏—Ç—å ‚Üí</span>
        </div>
    </a>
    
    <!-- Health Check -->
    <a href="/health" class="card" style="text-decoration: none;">
        <div class="card-icon">üè•</div>
        <h2 class="card-title">Health Check</h2>
        <p class="card-description">
            –ü—Ä–æ–≤–µ—Ä—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, –Ω–µ—Ç –ª–∏ –ø—Ä–æ–±–ª–µ–º.
        </p>
        <div style="margin-top: 1rem;">
            <span class="btn btn-success">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å ‚Üí</span>
        </div>
    </a>
    
    <!-- –ü–æ–º–æ—â—å -->
    <a href="/help" class="card" style="text-decoration: none;">
        <div class="card-icon">üìö</div>
        <h2 class="card-title">–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</h2>
        <p class="card-description">
            –£–∑–Ω–∞–π –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI Toolkit, —á—Ç–æ —Ç–∞–∫–æ–µ venv –≤–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ.
        </p>
        <div style="margin-top: 1rem;">
            <span class="btn btn-purple">–£–∑–Ω–∞—Ç—å ‚Üí</span>
        </div>
    </a>
</div>

<!-- –ë—ã—Å—Ç—Ä–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div style="margin-top: 4rem;">
    <h2 style="text-align: center; margin-bottom: 2rem;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
    <div id="stats-container">
        <div class="loader active">
            <div class="spinner"></div>
            <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>
</div>

<!-- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ IDE -->
<div style="margin-top: 4rem;">
    <h2 style="text-align: center; margin-bottom: 2rem;">üñ•Ô∏è –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ IDE</h2>
    <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
        {% for key, cfg in ide_configs.items() %}
        <div class="card" style="text-align: center; padding: 1.5rem;">
            <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">{{ cfg.icon }}</div>
            <div style="font-weight: 700;">{{ cfg.name }}</div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    async function loadStats() {
        const container = document.getElementById('stats-container');
        
        try {
            const response = await fetch('/api/stats');
            const data = await response.json();
            
            if (data.success) {
                if (data.projects_count > 0) {
                    container.innerHTML = `
                        <div class="card">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem; text-align: center;">
                                <div>
                                    <div style="font-size: 3rem; font-weight: 800; color: var(--accent-blue);">
                                        ${data.projects_count}
                                    </div>
                                    <div style="color: var(--text-secondary);">–ü—Ä–æ–µ–∫—Ç–æ–≤</div>
                                </div>
                                <div>
                                    <div style="font-size: 3rem; font-weight: 800; color: var(--accent-green);">
                                        ${data.projects.reduce((sum, p) => sum + p.size_mb, 0).toFixed(0)}
                                    </div>
                                    <div style="color: var(--text-secondary);">MB –≤—Å–µ–≥–æ</div>
                                </div>
                                <div>
                                    <div style="font-size: 3rem; font-weight: 800; color: var(--accent-purple);">
                                        v${data.toolkit_version}
                                    </div>
                                    <div style="color: var(--text-secondary);">–í–µ—Ä—Å–∏—è</div>
                                </div>
                            </div>
                            
                            ${data.projects.length > 0 ? `
                                <div style="margin-top: 2rem;">
                                    <h3 style="margin-bottom: 1rem;">–í–∞—à–∏ –ø—Ä–æ–µ–∫—Ç—ã:</h3>
                                    <div class="issue-list">
                                        ${data.projects.map(p => `
                                            <div class="issue-item info">
                                                <span class="issue-icon">üìÅ</span>
                                                <span class="issue-text"><strong>${p.name}</strong></span>
                                                <span class="issue-size">${p.size_mb} MB</span>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    `;
                } else {
                    container.innerHTML = `
                        <div class="card" style="text-align: center;">
                            <div style="font-size: 4rem; margin-bottom: 1rem;">üì≠</div>
                            <h3>–ü—Ä–æ–µ–∫—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                            <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                                –°–æ–∑–¥–∞–π —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç!
                            </p>
                            <a href="/create" class="btn btn-primary btn-lg">üÜï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</a>
                        </div>
                    `;
                }
            }
        } catch (error) {
            container.innerHTML = `
                <div class="alert alert-info">
                    <span class="alert-icon">‚ÑπÔ∏è</span>
                    <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</span>
                </div>
            `;
        }
    }
    
    loadStats();
</script>
{% endblock %}

